@use '../maps_and_variables/base' as *;
@use '../maps_and_variables/typography' as *;
@use 'sass:color';

$accordion-bg: white !default;
$accordion-border: $border !default;
$accordion-font-size: $font-size !default;
$accordion-font-weight: 600 !default;
$accordion-padding: 1rem !default;
$accordion-title-bg: rgb(245 245 245) !default;
$accordion-title-color: $text-color !default;

// must run after $accordion-title-bg and $accordion-title-color are defined
$accordion-hover-bg: color.adjust($accordion-title-bg, $lightness: -5%) !default;

// ============================================================================
// -- GENERIC ACCORDION STYLES --
// ============================================================================
// These styles provide the basic structure for the accordion and work
// with both the CSS and Alpine versions.

.accordion {
    background-color: $accordion-bg;
    border: $accordion-border;
    overflow: hidden;

    // accordion trigger
    :where(.accordion-title, button) {
        align-items: center;
        background: $accordion-title-bg;
        color: $accordion-title-color;
        cursor: pointer;
        display: flex;
        font-size: $accordion-font-size;
        font-weight: $accordion-font-weight;
        justify-content: space-between;
        padding: $accordion-padding;
        transition: background 0.3s ease;
        width: 100%;

        &:hover {
            background: $accordion-hover-bg;
        }

        // Handle SVG chevron rotation
        svg {
            transition: transform 0.3s ease;
        }
    }

    // Base content styling (works with Alpine x-collapse)
    &-content {
        padding: 0 $accordion-padding;
    }
}

// ============================================================================
// -- CSS ACCORDION STYLES --
// ============================================================================
// Only apply these styles when NOT using Alpine (x-data)

.accordion:not([x-data]) {
    // CSS-only accordion content needs transitions
    .accordion-content {
        max-height: 0;
        overflow: hidden;
        transition:
            max-height 0.3s ease,
            padding 0.3s ease;
    }

    // Hide the input used for CSS accordion toggle
    // Supports both checkbox (multiple open) and radio button (one open) methods
    > input[data-accordion-toggle] {
        display: none;

        // checked/selected toggles open and closed
        &:checked {
            + label {
                background: $accordion-hover-bg;

                // Rotate the SVG chevron
                svg {
                    transform: rotate(180deg);
                }
            }

            ~ .accordion-content {
                max-height: 100vh;
                padding: 1rem;
            }
        }
    }
}
