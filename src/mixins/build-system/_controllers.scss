@use './layers' as *;
@use './normalise-config' as *;
@use 'sass:map';

// ============================================================================
// Controller: Base classes only
// ============================================================================
@mixin build-base-classes($properties-map, $responsive: false, $with-state: false) {
    @each $property, $config in $properties-map {
        $normalised: normalise-config($property, $config, $responsive, $with-state);

        // Layer 1: Base classes
        @include build-base-layer($normalised);
    }
}

// ============================================================================
// Controller: Responsive classes only
// ============================================================================
@mixin build-responsive-classes($properties-map, $responsive: true, $with-state: false) {
    @each $property, $config in $properties-map {
        $normalised: normalise-config($property, $config, $responsive, $with-state);

        // Layer 2: Responsive variants
        @if map.get($normalised, 'breakpoints') {
            @include build-responsive-layer($normalised);
        }
    }
}

// ============================================================================
// Controller: Grand unified - Base + Responsive
// ============================================================================
@mixin build-classes-2($properties-map, $responsive: false, $with-state: false) {
    @each $property, $config in $properties-map {
        $normalised: normalise-config($property, $config, $responsive, $with-state);

        // Layer 1: Base classes
        @include build-base-layer($normalised);

        // Layer 2: Responsive variants
        @if map.get($normalised, 'breakpoints') {
            @include build-responsive-layer($normalised);
        }
    }
}