// stylelint-disable at-rule-empty-line-before
// stylelint-disable scss/at-mixin-pattern
@use '../maps_and_variables/base' as *;
@use 'sass:list';
@use 'sass:map';

// ============================================================================
// Responsive Query Mixins
// ============================================================================
// Unified mixins for both media queries and container queries.
//
// Media queries support all patterns:
// - on-{size}: Target specific breakpoint range only
// - from-{size}: Target breakpoint and larger (mobile-first)
// - to-{size}: Target up to but not including breakpoint
//
// Container queries mirror the same patterns with 'cq-' prefix:
// - cq-on-{size}: Target specific container width range only
// - cq-from-{size}: Target container width and larger
// - cq-to-{size}: Target up to but not including container width
//
// Usage:
// @include from-md { ... }       // Media query
// @include cq-from-md { ... }    // Container query
// ============================================================================

// ============================================================================
// Internal Core Query Logic - Single Source of Truth
// ============================================================================

@mixin _from($breakpoint, $type) {
    $bp: map.get($breakpoints, $breakpoint);

    @if $type == 'container' {
        @if $breakpoint == 'xxl' {
            @container (width >= calc(#{$bp} - 50px)) { @content; }
        } @else {
            @container (width >= #{$bp}) { @content; }
        }
    } @else {
        @media (width >= #{$bp}) { @content; }
    }
}

@mixin _on($breakpoint, $type) {
    $bp: map.get($breakpoints, $breakpoint);
    $breakpoint-names: ('sm', 'md', 'lg', 'xl', 'xxl');
    $current-index: list.index($breakpoint-names, $breakpoint);
    $next-bp: null;

    @if $current-index and $current-index < list.length($breakpoint-names) {
        $next-bp: map.get($breakpoints, list.nth($breakpoint-names, $current-index + 1));
    }

    @if $next-bp {
        @if $type == 'container' {
            @container (#{$bp} <= width < #{$next-bp}) { @content; }
        } @else {
            @media (#{$bp} <= width < #{$next-bp}) { @content; }
        }
    } @else {
        @if $type == 'container' {
            @container (width >= #{$bp}) { @content; }
        } @else {
            @media (width >= #{$bp}) { @content; }
        }
    }
}

@mixin _to($breakpoint, $type) {
    $bp: map.get($breakpoints, $breakpoint);

    @if $type == 'container' {
        @container (width < #{$bp}) { @content; }
    } @else {
        @media (width < #{$bp}) { @content; }
    }
}

// ============================================================================
// Public API - Media Query Mixins
// ============================================================================

@mixin from-sm { @include _from('sm', 'media') { @content; } }
@mixin from-md { @include _from('md', 'media') { @content; } }
@mixin from-lg { @include _from('lg', 'media') { @content; } }
@mixin from-xl { @include _from('xl', 'media') { @content; } }
@mixin from-xxl { @include _from('xxl', 'media') { @content; } }

@mixin on-sm { @include _on('sm', 'media') { @content; } }
@mixin on-md { @include _on('md', 'media') { @content; } }
@mixin on-lg { @include _on('lg', 'media') { @content; } }
@mixin on-xl { @include _on('xl', 'media') { @content; } }
@mixin on-xxl { @include _on('xxl', 'media') { @content; } }

@mixin to-sm { @include _to('sm', 'media') { @content; } }
@mixin to-md { @include _to('md', 'media') { @content; } }
@mixin to-lg { @include _to('lg', 'media') { @content; } }
@mixin to-xl { @include _to('xl', 'media') { @content; } }

// ============================================================================
// Public API - Container Query Mixins
// ============================================================================

@mixin cq-from-sm { @include _from('sm', 'container') { @content; } }
@mixin cq-from-md { @include _from('md', 'container') { @content; } }
@mixin cq-from-lg { @include _from('lg', 'container') { @content; } }
@mixin cq-from-xl { @include _from('xl', 'container') { @content; } }
@mixin cq-from-xxl { @include _from('xxl', 'container') { @content; } }

@mixin cq-on-sm { @include _on('sm', 'container') { @content; } }
@mixin cq-on-md { @include _on('md', 'container') { @content; } }
@mixin cq-on-lg { @include _on('lg', 'container') { @content; } }
@mixin cq-on-xl { @include _on('xl', 'container') { @content; } }
@mixin cq-on-xxl { @include _on('xxl', 'container') { @content; } }

@mixin cq-to-sm { @include _to('sm', 'container') { @content; } }
@mixin cq-to-md { @include _to('md', 'container') { @content; } }
@mixin cq-to-lg { @include _to('lg', 'container') { @content; } }
@mixin cq-to-xl { @include _to('xl', 'container') { @content; } }
